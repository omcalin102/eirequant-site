import{r,R as t,E as h}from"./index.CzO9CTmw.js";import"./_commonjsHelpers.CqkleIqs.js";async function x(a){try{const n=await fetch(a);return n.ok?await n.json():null}catch{return null}}function b(a){let n=a[0]??1;return a.map(l=>(n=Math.max(n,l),l/n-1))}function E(a,n=60){const l=[];for(let c=0;c<a.length;c++){const s=Math.max(0,c-n+1),d=a.slice(s,c+1),g=d.reduce((m,p)=>m+p,0)/(d.length||1),u=Math.sqrt(d.reduce((m,p)=>m+(p-g)**2,0)/(d.length||1));l.push(u?g/u*Math.sqrt(252):0)}return l}function S(){const[a,n]=r.useState(null),[l,c]=r.useState([]),[s,d]=r.useState([]),[g,u]=r.useState(!1);r.useEffect(()=>{(async()=>{const e=await x("/data/universe_v1/registry.json");n(e),e?.curves?.length&&c(e.curves.slice(0,3).map(i=>i.id))})()},[]),r.useEffect(()=>{(async()=>{if(!a)return;u(!0);const e=[];for(const i of l){const f=a.curves.find(v=>v.id===i);if(!f?.path)continue;const o=await x(`/data/universe_v1/${f.path}`);o&&e.push({id:i,label:o.label??i,dates:o.dates??[],nav:o.nav??[],ret:o.ret??[]})}d(e),u(!1)})()},[a,l]);const m=r.useMemo(()=>({tooltip:{trigger:"axis"},legend:{},xAxis:{type:"category",data:s[0]?.dates??[]},yAxis:{type:"value"},series:s.map(e=>({name:e.label,type:"line",data:e.nav}))}),[s]),p=r.useMemo(()=>({tooltip:{trigger:"axis"},legend:{},xAxis:{type:"category",data:s[0]?.dates??[]},yAxis:{type:"value"},series:s.map(e=>({name:e.label,type:"line",data:b(e.nav)}))}),[s]),y=r.useMemo(()=>({tooltip:{trigger:"axis"},legend:{},xAxis:{type:"category",data:s[0]?.dates??[]},yAxis:{type:"value"},series:s.map(e=>({name:e.label,type:"line",data:E(e.ret)}))}),[s]);return t.createElement("div",{className:"space-y-4"},a?t.createElement("div",{className:"flex flex-wrap gap-2"},a.curves.map(e=>t.createElement("label",{key:e.id,className:"text-sm inline-flex items-center gap-2 border px-3 py-1.5 rounded-lg"},t.createElement("input",{type:"checkbox",checked:l.includes(e.id),onChange:i=>c(f=>i.target.checked?[...new Set([...f,e.id])]:f.filter(o=>o!==e.id))}),e.label))):t.createElement("div",{className:"rounded-2xl border bg-yellow-50 p-4"},"No registry yet. Drop files under ",t.createElement("code",null,"/public/data/universe_v1/"),"."),g&&t.createElement("div",{className:"text-sm text-neutral-600"},"Loading curvesâ€¦"),t.createElement("div",{className:"rounded-2xl border bg-white p-4"},t.createElement("h2",{className:"font-medium mb-2"},"Cumulative NAV"),t.createElement(h,{option:m,className:"w-full h-80"})),t.createElement("div",{className:"rounded-2xl border bg-white p-4"},t.createElement("h2",{className:"font-medium mb-2"},"Drawdown"),t.createElement(h,{option:p,className:"w-full h-80"})),t.createElement("div",{className:"rounded-2xl border bg-white p-4"},t.createElement("h2",{className:"font-medium mb-2"},"Rolling Sharpe (60d)"),t.createElement(h,{option:y,className:"w-full h-80"})))}export{S as default};
