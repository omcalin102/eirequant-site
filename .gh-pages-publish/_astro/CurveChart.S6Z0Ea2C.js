import{j as h}from"./jsx-runtime.D_zvdyIk.js";import{r as n}from"./index.GzzYzsTh.js";import{c as B,s as z,a as Z,b as ee,d as ge,e as G,g as Ae,i as ae,f as V,h as be,r as te,u as re,R as Pe,S as Ie,j as Ee,k as ke,l as Ce,m as ie,n as je,o as Se,p as De,q as we,t as Ne,G as Oe,v as ne,w as se,x as le,L as R,y as Le,A as F,z as X,B as Y,C as L,D as We,J as Re,E as O,F as _e,H as Te,I as oe,K as M,M as Me,N as _,O as Ke,P as Be,Q as ze,T as $,U as Ge,V as q,X as H,Y as J,W as U,Z as Ve,_ as Fe}from"./LineChart.Di7AruUN.js";import"./index.BSy9ry4M.js";var ce=(a,e,t,r)=>Z(a,"xAxis",e,r),ue=(a,e,t,r)=>ee(a,"xAxis",e,r),de=(a,e,t,r)=>Z(a,"yAxis",t,r),pe=(a,e,t,r)=>ee(a,"yAxis",t,r),Xe=B([z,ce,de,ue,pe],(a,e,t,r,s)=>ae(a,"xAxis")?V(e,r,!1):V(t,s,!1)),Ye=(a,e,t,r,s)=>s,ve=B([be,Ye],(a,e)=>a.filter(t=>t.type==="area").find(t=>t.id===e)),$e=(a,e,t,r,s)=>{var i,c=ve(a,e,t,r,s);if(c!=null){var o=z(a),l=ae(o,"xAxis"),u;if(l?u=G(a,"yAxis",t,r):u=G(a,"xAxis",e,r),u!=null){var{stackId:f}=c,g=Ae(c);if(!(f==null||g==null)){var p=(i=u[f])===null||i===void 0?void 0:i.stackedData;return p?.find(v=>v.key===g)}}}},qe=B([z,ce,de,ue,pe,$e,ge,Xe,ve],(a,e,t,r,s,i,c,o,l)=>{var{chartData:u,dataStartIndex:f,dataEndIndex:g}=c;if(!(l==null||a!=="horizontal"&&a!=="vertical"||e==null||t==null||r==null||s==null||r.length===0||s.length===0||o==null)){var{data:p}=l,v;if(p&&p.length>0?v=p:v=u?.slice(f,g+1),v!=null){var y=void 0;return ha({layout:a,xAxis:e,yAxis:t,xAxisTicks:r,yAxisTicks:s,dataStartIndex:f,areaSettings:l,stackedData:i,displayedData:v,chartBaseValue:y,bandSize:o})}}}),He=["id"],Je=["activeDot","animationBegin","animationDuration","animationEasing","connectNulls","dot","fill","fillOpacity","hide","isAnimationActive","legendType","stroke","xAxisId","yAxisId"];function he(a,e){if(a==null)return{};var t,r,s=Ue(a,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(a);for(r=0;r<i.length;r++)t=i[r],e.indexOf(t)===-1&&{}.propertyIsEnumerable.call(a,t)&&(s[t]=a[t])}return s}function Ue(a,e){if(a==null)return{};var t={};for(var r in a)if({}.hasOwnProperty.call(a,r)){if(e.indexOf(r)!==-1)continue;t[r]=a[r]}return t}function Q(a,e){var t=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(a,s).enumerable})),t.push.apply(t,r)}return t}function N(a){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Q(Object(t),!0).forEach(function(r){Qe(a,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(t)):Q(Object(t)).forEach(function(r){Object.defineProperty(a,r,Object.getOwnPropertyDescriptor(t,r))})}return a}function Qe(a,e,t){return(e=Ze(e))in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}function Ze(a){var e=ea(a,"string");return typeof e=="symbol"?e:e+""}function ea(a,e){if(typeof a!="object"||!a)return a;var t=a[Symbol.toPrimitive];if(t!==void 0){var r=t.call(a,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(a)}function C(){return C=Object.assign?Object.assign.bind():function(a){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(a[r]=t[r])}return a},C.apply(null,arguments)}function T(a,e){return a&&a!=="none"?a:e}var aa=a=>{var{dataKey:e,name:t,stroke:r,fill:s,legendType:i,hide:c}=a;return[{inactive:c,dataKey:e,type:i,color:T(r,s),value:ie(t,e),payload:a}]};function ta(a){var{dataKey:e,data:t,stroke:r,strokeWidth:s,fill:i,name:c,hide:o,unit:l}=a;return{dataDefinedOnItem:t,positions:void 0,settings:{stroke:r,strokeWidth:s,fill:i,dataKey:e,nameKey:void 0,name:ie(c,e),hide:o,type:a.tooltipType,color:T(r,i),unit:l}}}var ra=(a,e)=>{var t;if(n.isValidElement(a))t=n.cloneElement(a,e);else if(typeof a=="function")t=a(e);else{var r=ne("recharts-area-dot",typeof a!="boolean"?a.className:"");t=n.createElement(Ke,C({},e,{className:r}))}return t};function ia(a,e){return a==null?!1:e?!0:a.length===1}function na(a){var{clipPathId:e,points:t,props:r}=a,{needClip:s,dot:i,dataKey:c}=r;if(!ia(t,i))return null;var o=le(i),l=oe(r),u=se(i,!0),f=t.map((p,v)=>{var y=N(N(N({key:"dot-".concat(v),r:3},l),u),{},{index:v,cx:p.x,cy:p.y,dataKey:c,value:p.value,payload:p.payload,points:t});return ra(i,y)}),g={clipPath:s?"url(#clipPath-".concat(o?"":"dots-").concat(e,")"):void 0};return n.createElement(R,C({className:"recharts-area-dots"},g),f)}function K(a){var{points:e,baseLine:t,needClip:r,clipPathId:s,props:i,showLabels:c}=a,{layout:o,type:l,stroke:u,connectNulls:f,isRange:g}=i,{id:p}=i,v=he(i,He),y=oe(v);return n.createElement(n.Fragment,null,e?.length>1&&n.createElement(R,{clipPath:r?"url(#clipPath-".concat(s,")"):void 0},n.createElement(M,C({},y,{id:p,points:e,connectNulls:f,type:l,baseLine:t,layout:o,stroke:"none",className:"recharts-area-area"})),u!=="none"&&n.createElement(M,C({},y,{className:"recharts-area-curve",layout:o,type:l,connectNulls:f,fill:"none",points:e})),u!=="none"&&g&&n.createElement(M,C({},y,{className:"recharts-area-curve",layout:o,type:l,connectNulls:f,fill:"none",points:t}))),n.createElement(na,{points:e,props:v,clipPathId:s}),c&&Me.renderCallByParent(v,e))}function sa(a){var{alpha:e,baseLine:t,points:r,strokeWidth:s}=a,i=r[0].y,c=r[r.length-1].y;if(!_(i)||!_(c))return null;var o=e*Math.abs(i-c),l=Math.max(...r.map(u=>u.x||0));return L(t)?l=Math.max(t,l):t&&Array.isArray(t)&&t.length&&(l=Math.max(...t.map(u=>u.x||0),l)),L(l)?n.createElement("rect",{x:0,y:i<c?i:i-o,width:l+(s?parseInt("".concat(s),10):1),height:Math.floor(o)}):null}function la(a){var{alpha:e,baseLine:t,points:r,strokeWidth:s}=a,i=r[0].x,c=r[r.length-1].x;if(!_(i)||!_(c))return null;var o=e*Math.abs(i-c),l=Math.max(...r.map(u=>u.y||0));return L(t)?l=Math.max(t,l):t&&Array.isArray(t)&&t.length&&(l=Math.max(...t.map(u=>u.y||0),l)),L(l)?n.createElement("rect",{x:i<c?i:i-o,y:0,width:o,height:Math.floor(l+(s?parseInt("".concat(s),10):1))}):null}function oa(a){var{alpha:e,layout:t,points:r,baseLine:s,strokeWidth:i}=a;return t==="vertical"?n.createElement(sa,{alpha:e,points:r,baseLine:s,strokeWidth:i}):n.createElement(la,{alpha:e,points:r,baseLine:s,strokeWidth:i})}function ca(a){var{needClip:e,clipPathId:t,props:r,previousPointsRef:s,previousBaselineRef:i}=a,{points:c,baseLine:o,isAnimationActive:l,animationBegin:u,animationDuration:f,animationEasing:g,onAnimationStart:p,onAnimationEnd:v}=r,y=We(r,"recharts-area-"),[I,A]=n.useState(!0),k=n.useCallback(()=>{typeof v=="function"&&v(),A(!1)},[v]),E=n.useCallback(()=>{typeof p=="function"&&p(),A(!0)},[p]),b=s.current,d=i.current;return n.createElement(Re,{begin:u,duration:f,isActive:l,easing:g,onAnimationEnd:k,onAnimationStart:E,key:y},m=>{if(b){var x=b.length/c.length,j=m===1?c:c.map((P,W)=>{var D=Math.floor(W*x);if(b[D]){var w=b[D];return N(N({},P),{},{x:O(w.x,P.x,m),y:O(w.y,P.y,m)})}return P}),S;return L(o)?S=O(d,o,m):_e(o)||Te(o)?S=O(d,0,m):S=o.map((P,W)=>{var D=Math.floor(W*x);if(Array.isArray(d)&&d[D]){var w=d[D];return N(N({},P),{},{x:O(w.x,P.x,m),y:O(w.y,P.y,m)})}return P}),m>0&&(s.current=j,i.current=S),n.createElement(K,{points:j,baseLine:S,needClip:e,clipPathId:t,props:r,showLabels:!I})}return m>0&&(s.current=c,i.current=o),n.createElement(R,null,n.createElement("defs",null,n.createElement("clipPath",{id:"animationClipPath-".concat(t)},n.createElement(oa,{alpha:m,points:c,baseLine:o,layout:r.layout,strokeWidth:r.strokeWidth}))),n.createElement(R,{clipPath:"url(#animationClipPath-".concat(t,")")},n.createElement(K,{points:c,baseLine:o,needClip:e,clipPathId:t,props:r,showLabels:!0})))})}function ua(a){var{needClip:e,clipPathId:t,props:r}=a,{points:s,baseLine:i,isAnimationActive:c}=r,o=n.useRef(null),l=n.useRef(),u=o.current,f=l.current;return c&&s&&s.length&&(u!==s||f!==i)?n.createElement(ca,{needClip:e,clipPathId:t,props:r,previousPointsRef:o,previousBaselineRef:l}):n.createElement(K,{points:s,baseLine:i,needClip:e,clipPathId:t,props:r,showLabels:!0})}class da extends n.PureComponent{render(){var e,{hide:t,dot:r,points:s,className:i,top:c,left:o,needClip:l,xAxisId:u,yAxisId:f,width:g,height:p,id:v,baseLine:y}=this.props;if(t)return null;var I=ne("recharts-area",i),A=v,{r:k=3,strokeWidth:E=2}=(e=se(r,!1))!==null&&e!==void 0?e:{r:3,strokeWidth:2},b=le(r),d=k*2+E;return n.createElement(n.Fragment,null,n.createElement(R,{className:I},l&&n.createElement("defs",null,n.createElement(Le,{clipPathId:A,xAxisId:u,yAxisId:f}),!b&&n.createElement("clipPath",{id:"clipPath-dots-".concat(A)},n.createElement("rect",{x:o-d/2,y:c-d/2,width:g+d,height:p+d}))),n.createElement(ua,{needClip:l,clipPathId:A,props:this.props})),n.createElement(F,{points:s,mainColor:T(this.props.stroke,this.props.fill),itemDataKey:this.props.dataKey,activeDot:this.props.activeDot}),this.props.isRange&&Array.isArray(y)&&n.createElement(F,{points:y,mainColor:T(this.props.stroke,this.props.fill),itemDataKey:this.props.dataKey,activeDot:this.props.activeDot}))}}var fe={activeDot:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!1,fill:"#3182bd",fillOpacity:.6,hide:!1,isAnimationActive:!Oe.isSsr,legendType:"line",stroke:"#3182bd",xAxisId:0,yAxisId:0};function pa(a){var e,t=te(a,fe),{activeDot:r,animationBegin:s,animationDuration:i,animationEasing:c,connectNulls:o,dot:l,fill:u,fillOpacity:f,hide:g,isAnimationActive:p,legendType:v,stroke:y,xAxisId:I,yAxisId:A}=t,k=he(t,Je),E=je(),b=Se(),{needClip:d}=De(I,A),m=re(),{points:x,isRange:j,baseLine:S}=(e=we(xe=>qe(xe,I,A,m,a.id)))!==null&&e!==void 0?e:{},P=Ne();if(E!=="horizontal"&&E!=="vertical"||P==null||b!=="AreaChart"&&b!=="ComposedChart")return null;var{height:W,width:D,x:w,y:ye}=P;return!x||!x.length?null:n.createElement(da,C({},k,{activeDot:r,animationBegin:s,animationDuration:i,animationEasing:c,baseLine:S,connectNulls:o,dot:l,fill:u,fillOpacity:f,height:W,hide:g,layout:E,isAnimationActive:p,isRange:j,legendType:v,needClip:d,points:x,stroke:y,width:D,left:w,top:ye,xAxisId:I,yAxisId:A}))}var va=(a,e,t,r,s)=>{var i=t??e;if(L(i))return i;var c=a==="horizontal"?s:r,o=c.scale.domain();if(c.type==="number"){var l=Math.max(o[0],o[1]),u=Math.min(o[0],o[1]);return i==="dataMin"?u:i==="dataMax"||l<0?l:Math.max(Math.min(o[0],o[1]),0)}return i==="dataMin"?o[0]:i==="dataMax"?o[1]:o[0]};function ha(a){var{areaSettings:{connectNulls:e,baseValue:t,dataKey:r},stackedData:s,layout:i,chartBaseValue:c,xAxis:o,yAxis:l,displayedData:u,dataStartIndex:f,xAxisTicks:g,yAxisTicks:p,bandSize:v}=a,y=s&&s.length,I=va(i,c,t,o,l),A=i==="horizontal",k=!1,E=u.map((d,m)=>{var x;y?x=s[f+m]:(x=X(d,r),Array.isArray(x)?k=!0:x=[I,x]);var j=x[1]==null||y&&!e&&X(d,r)==null;return A?{x:Y({axis:o,ticks:g,bandSize:v,entry:d,index:m}),y:j?null:l.scale(x[1]),value:x,payload:d}:{x:j?null:o.scale(x[1]),y:Y({axis:l,ticks:p,bandSize:v,entry:d,index:m}),value:x,payload:d}}),b;return y||k?b=E.map(d=>{var m=Array.isArray(d.value)?d.value[0]:null;return A?{x:d.x,y:m!=null&&d.y!=null?l.scale(m):null,payload:d.payload}:{x:m!=null?o.scale(m):null,y:d.y,payload:d.payload}}):b=A?l.scale(I):o.scale(I),{points:E,baseLine:b,isRange:k}}function me(a){var e=te(a,fe),t=re();return n.createElement(Pe,{id:e.id,type:"area"},r=>n.createElement(n.Fragment,null,n.createElement(Ie,{legendPayload:aa(e)}),n.createElement(Ee,{fn:ta,args:e}),n.createElement(ke,{type:"area",id:r,data:e.data,dataKey:e.dataKey,xAxisId:e.xAxisId,yAxisId:e.yAxisId,zAxisId:0,stackId:Ce(e.stackId),hide:e.hide,barSize:void 0,baseValue:e.baseValue,isPanorama:t,connectNulls:e.connectNulls}),n.createElement(pa,C({},e,{id:r}))))}me.displayName="Area";var fa=["axis"],ma=n.forwardRef((a,e)=>n.createElement(Be,{chartName:"AreaChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:fa,tooltipPayloadSearcher:ze,categoricalChartProps:a,ref:e}));const ya=a=>a.startsWith("/")||a.startsWith("http");async function xa(a){const e=ya(a)?a:`/data/universe_v1/curves/${a}.json`,t=await fetch(e,{cache:"no-cache"});if(!t.ok)throw new Error(`Curve fetch failed: ${e}`);return t.json()}function ga(a){let e=0;return a.map(t=>{e=Math.max(e,t.value||0);const r=e?t.value/e-1:0;return{date:t.date,value:r}})}function Ea({chartKey:a,title:e="Equity Curve",showDrawdown:t=!1}){const[r,s]=n.useState(null),[i,c]=n.useState(null);n.useEffect(()=>{if(s(null),c(null),!a){c("No chartKey provided.");return}xa(a).then(s).catch(l=>c(String(l)))},[a]);const o=n.useMemo(()=>r?ga(r.series):[],[r]);return i?h.jsx("div",{style:{color:"#b91c1c"},children:i}):r?h.jsxs("div",{className:"curve",children:[h.jsx("h3",{children:e}),h.jsx("div",{className:"panel",children:h.jsx($,{width:"100%",height:320,children:h.jsxs(Ge,{data:r.series,children:[h.jsx(q,{strokeDasharray:"3 3"}),h.jsx(H,{dataKey:"date",minTickGap:30}),h.jsx(J,{}),h.jsx(U,{}),h.jsx(Ve,{}),h.jsx(Fe,{type:"monotone",dataKey:"value",name:r.meta?.label||"Equity",dot:!1,stroke:"#2563eb",strokeWidth:2,isAnimationActive:!1})]})})}),t&&h.jsx("div",{className:"panel",children:h.jsx($,{width:"100%",height:220,children:h.jsxs(ma,{data:o,children:[h.jsx(q,{strokeDasharray:"3 3"}),h.jsx(H,{dataKey:"date",minTickGap:30}),h.jsx(J,{tickFormatter:l=>`${(l*100).toFixed(0)}%`}),h.jsx(U,{formatter:l=>[`${(l*100).toFixed(2)}%`,"Drawdown"]}),h.jsx(me,{type:"monotone",dataKey:"value",name:"Drawdown",stroke:"#dc2626",fill:"#fecaca",isAnimationActive:!1})]})})}),h.jsx("style",{children:`
        .curve h3{ margin:.25rem 0 .5rem; }
        .panel{ border:1px solid #eee; border-radius:12px; padding:.5rem; background:#fff; margin-bottom:.5rem; }
      `})]}):h.jsx("div",{children:"Loadingâ€¦"})}export{Ea as default};
