import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as o}from"./index.CQ95-tCy.js";import{g as x,c as v}from"./api.BFLoCgOV.js";const h=(t,m=2)=>typeof t=="number"&&isFinite(t)?`${(t*100).toFixed(m)}%`:"�";function d(t){return t?.type==="sector"||"sector"in t?"sector":t?.type==="ticker"||"ticker"in t?"ticker":t?.type==="news"||"title"in t?"news":"other"}function w(){const[t,m]=o.useState(null),[i,u]=o.useState([]);o.useEffect(()=>{(async()=>{const r=await x();m(r);const a=await v(r??void 0,"eqx-m1");u(a?.drivers??[])})()},[]);const p=o.useMemo(()=>{const r=i.filter(s=>d(s)==="sector").sort((s,l)=>(l.value??0)-(s.value??0)),a=i.filter(s=>d(s)==="ticker").sort((s,l)=>Math.abs(l.value??0)-Math.abs(s.value??0)),n=i.filter(s=>d(s)==="news").sort((s,l)=>(l.sentiment??0)-(s.sentiment??0)),c=[...r.slice(0,3),...a.slice(0,2),...n.slice(0,1)];return c.length?c:[...i].sort((s,l)=>Math.abs(l.value??0)-Math.abs(s.value??0)).slice(0,6)},[i]);return e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-head",children:[e.jsx("h3",{className:"card-title",children:"Top Drivers"}),e.jsx("div",{className:"card-sub",children:t??"�"})]}),p.length?e.jsx("ul",{className:"list topdrivers-list",style:{marginTop:".5rem"},children:p.map((r,a)=>{const n=d(r);if(n==="sector")return e.jsxs("li",{className:"row",style:{display:"flex",gap:".5rem",alignItems:"center"},children:[e.jsx("span",{className:"badge",children:"Sector"}),e.jsx("span",{className:"kv-key",style:{flex:1,minWidth:0},children:r.sector??"�"}),e.jsx("span",{className:"kv-val muted",children:h(r.value)})]},`s${a}`);if(n==="ticker")return e.jsxs("li",{className:"row",style:{display:"flex",gap:".5rem",alignItems:"center"},children:[e.jsx("span",{className:"badge",children:"Ticker"}),e.jsx("span",{className:"kv-key",style:{flex:1,minWidth:0},children:r.ticker??"�"}),e.jsx("span",{className:"kv-val muted",children:h(r.value)})]},`t${a}`);if(n==="news"){const c=r.title??"News";return e.jsxs("li",{className:"row news-row",style:{display:"grid",gridTemplateColumns:"auto 1fr",gap:".5rem",alignItems:"start"},children:[e.jsx("span",{className:"badge",children:"News"}),e.jsx("span",{className:"news-title",title:c,children:c})]},`n${a}`)}return e.jsxs("li",{className:"row",style:{display:"flex",gap:".5rem",alignItems:"center"},children:[e.jsx("span",{className:"badge",children:"Info"}),e.jsx("span",{style:{flex:1},children:"�"}),e.jsx("span",{className:"muted",children:"�"})]},`x${a}`)})}):e.jsx("div",{className:"muted",style:{marginTop:".5rem"},children:"No drivers available."}),e.jsx("style",{children:`
        .topdrivers-list { gap: .35rem; }
        .topdrivers-list > li + li { border-top:1px solid var(--border); padding-top:.35rem; margin-top:.35rem; }
        /* Full-width headline, wrap on spaces only */
        .news-title {
          display:block;
          white-space: normal;
          word-break: keep-all;
          overflow-wrap: break-word;
          hyphens: none;
          line-height: 1.25;
        }
      `})]})}export{w as default};
